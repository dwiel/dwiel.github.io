<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 5 | Zach Dwiel</title>
  <meta name="author" content="Zach Dwiel">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Zach Dwiel"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Zach Dwiel" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Zach Dwiel</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.171Z"><a href="/2015/10/02/mongorestore-error-root-directory-must-be-a-dump-of-a-single-collection-when-specifying-a-collection-name-with-collection/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/mongorestore-error-root-directory-must-be-a-dump-of-a-single-collection-when-specifying-a-collection-name-with-collection/"> mongorestore: ERROR: root directory must be a dump of a single collection when specifying a collection name with --collection </a></h1>
  

    </header>
    <div class="entry">
      
        <p>mongorestore wants the specific collection’s filename rather than the entire database’s dump folder:</p>
<style>span, strong { font-family: courier, monospace; }</style>

<p><em>dwiel@dwiel$</em> mongodump -d db -c variables -o ../backups/1<br>connected to: 127.0.0.1<br>DATABASE: db     to     ../backups/1/db<br>        db.variables to ../backups/1/db/variables.bson<br>                3 objects<br><em>dwiel@dwiel$</em> mongorestore -d db -c variables –drop ../backups/1<br>ERROR: root directory must be a dump of a single collection<br>       when specifying a collection name with –collection<br>usage: ……..<br><em>dwiel@dwiel$</em> mongorestore -d db -c variables –drop ../backups/1/db/variables.bson<br>connected to: 127.0.0.1<br>../backups/1/db/variables.bson<br>        going into namespace [db.variables]<br>        dropping<br>        3 objects</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.159Z"><a href="/2015/10/02/python-memcache-is-thread-safe/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/python-memcache-is-thread-safe/"> python-memcache is thread safe </a></h1>
  

    </header>
    <div class="entry">
      
        <p>python-memcache is a thread safe library.  In memcache.py, which is the single source file, you’ll find:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># Only exists in Python 2.4+</span></span><br><span class="line">    <span class="keyword">from</span> threading <span class="keyword">import</span> local</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>  add the pure-python local implementation</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">local</span><span class="params">(object)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span><span class="params">(local)</span>:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>Which means that all data accessed through self.variable_name have values which are thread specific (as long as you are running python version 2.4 or higher.)  Very cool.  Before I looked at the code, I wrote some multi-threaded tests to check and see if anything fishy would happen.  I’d say looking at the code is a better solution.</p>
<p>more details <a href="http://docs.python.org/library/threading.html#threading.local" target="_blank" rel="external">threading.local</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.151Z"><a href="/2015/10/02/python-random-timezone/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/python-random-timezone/"> python random timezone </a></h1>
  

    </header>
    <div class="entry">
      
        <figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> random</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> pytz</span></span><br><span class="line"> </span><br><span class="line">pytz.timezone(random.choice(pytz.all_timezones))</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.111Z"><a href="/2015/10/02/wx-1b-4200jwlau-datasheet/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/wx-1b-4200jwlau-datasheet/"> WX-1B-4200J/WLAU Datasheet </a></h1>
  

    </header>
    <div class="entry">
      
        <p>Spent a while looking for the datasheet for Nason’s WX-1B-4200J/WLAU.  Here it is: <a href="http://www.nasonptc.com/pdfs/Switches_Catalog.pdf#page=15" target="_blank" rel="external">pdf</a>, see page 15.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.091Z"><a href="/2015/10/02/first-look-at-the-foundation/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/first-look-at-the-foundation/"> First Look at the Foundation </a></h1>
  

    </header>
    <div class="entry">
      
        <p>I just went out to see the newly poured foundation, which was great. Shaina was worried that it wasn’t the right size, and there was some confusion earlier due to Tip’s drawing.  It indicated that the foundation should be 23’ 6” long instead of 27’ long. 23’ 6” is the correct <em>interior</em> length, but it was marked on the drawing as the <em>exterior</em> length. I measured the finished foundation and everything was the right size. The only reason we caught this was because my dad and I had staked out the corners of the foundation earlier using the correct dimensions, and the guys pouring the foundation noticed and asked about the discrepancy.  I did find out that the sewer pipe was placed inside the west wall instead of the east wall. Not good. Its sticking up right where the door is supposed to go … not sure what to do about it yet, waiting to hear back from Tip …</p>
<p><a href="http://dwiel.net/wp-content/uploads/2012/08/DSCF1703.jpg" target="_blank" rel="external"><img src="/images/DSCF1703-1024x768.jpg" alt=""></a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:52.023Z"><a href="/2015/10/02/growing-couscous/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/growing-couscous/"> Growing Couscous </a></h1>
  

    </header>
    <div class="entry">
      
        <p>Couscous is not grown.  <a href="http://en.wikipedia.org/wiki/Couscous#Couscous_from_semolina_.28wheat.29" target="_blank" rel="external">Couscous is made of wheat</a>, and traditionally rolled by hand for days before being sun dried for months.  doh</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:51.995Z"><a href="/2015/10/02/clustering-items-by-tag/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/clustering-items-by-tag/"> Clustering items by tag </a></h1>
  

    </header>
    <div class="entry">
      
        <p>I write notes in axpress, my still private web front end to a triple store.  The notes have a body and a set of tags.  Most notes are thoughts about problems I encounter while programming, explanations of design decisions.  They have come in handy as a reference a few times, but the information in them is often hard to find, even with tags.  I also find writing tags tedious.  I’ve decided to look through the various set of tagged items, my notes and my bookmarks to start, to see what kind of patterns I can find.</p>
<p>I used <a href="http://www.graphviz.org/" title="graphviz" target="_blank" rel="external">graphviz</a> to get a quick visualization of the relationships between each tag.  Each tag is a node.  Each node is labeled by the tag name and the number of notes it appears in.  The closer two nodes, the more often they occurred in the same notes.  Only tags which were connected to more than 1 other tag were included in the visualization to reduce the complexity.</p>
<p>From here, some basic patterns can be seen.some basic subgraphs can be seen.  “trade”, “local” and “books” all stem from “economy” only.  “economy” is probably a good tag to classify that group of notes where “trade”, “local” and “books” are sub tags.  A similar pattern can be seen coming from the express tag (which is the old name of this project).  Coming from it are some tags which I don’t seem to note any more.</p>
<p>Only visualizing pairs of tags which occurred more than 3 times, show which (common) tags are used with which other (common) tags, but not how often.  It is interesting to see which tags are independent of others.  “axpress” and “express” do not occur together often.  It might be possible to use this type of graph to find a set of tags which partition the entire set of notes efficiently.  This, hopefully small, set of tags could be used as a starting point for drilling down to find a note you are looking for.</p>
<p>For this next graph I wanted to see how ‘thick’ the connections between each node was.  That is, from “axpress” how many links are there to “case”?  How many to “design”?  Are there any tags which occur with nearly every instance of “axpress” or are they uniformly distributed?  The darker a node is, the more occurences of that tag there are (color corresponds linearly to number in the label).  The color on the end of each link correspond to the relative number of connections represented by that link.  For example coming from “code” is a dark green node to “axpress” and a lighter cyan to “case”.  This is because there are twice as many connections from “code” to “axpress” as to “case”.  From most tags, it seems that there is a relatively uniform number of connections to each other tag.</p>
<p>This set is rather limited, so I am considering a few different next steps.  I could use the text of the note in a similar kind of analysis - increasing the number of tags, leaving the number of tagged items alone.  Or I could use data from delicious (either my own, or a small set of users) to increase the number of tagged items while leacing the number of tags relatively small.  What would you like to see done next?  Something else entirely?</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:51.943Z"><a href="/2015/10/02/ruby-rescue-error-message-example/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/ruby-rescue-error-message-example/"> ruby rescue error message example </a></h1>
  

    </header>
    <div class="entry">
      
        <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">raise</span> <span class="string">"this is an error message"</span></span><br><span class="line">rescue <span class="keyword">Exception</span> =&gt; <span class="keyword">e</span></span><br><span class="line">  # prints <span class="string">"this is an error message"</span></span><br><span class="line">  puts <span class="keyword">e</span>.message</span><br><span class="line">  # <span class="keyword">or</span> <span class="keyword">if</span> you want the entire <span class="keyword">error</span> message <span class="keyword">with</span> stack <span class="keyword">trace</span> <span class="keyword">and</span> all:</span><br><span class="line">  puts <span class="string">"failed sending weekly power usage to house: #&#123;$!&#125;"</span></span><br><span class="line"><span class="keyword">end</span></span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:51.935Z"><a href="/2015/10/02/rails-headers/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/rails-headers/"> Rails Headers </a></h1>
  

    </header>
    <div class="entry">
      
        <p>You can access header values from rails from the request.env hash.  request.env contains a lot of other non HTTP header values.  The header name is a bit transformed too:</p>
<ul>
<li>prepended with HTTP_</li>
<li>converted to uppercase</li>
<li>dashes converted to undersocres</li>
<li>… more?</li>
</ul>
<p>Example:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">curl -H <span class="string">'x-custom-value: foo'</span> <span class="string">http:</span><span class="comment">//example.com/</span></span><br></pre></td></tr></table></figure>
<p>can be accessed in rails with:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">request<span class="class">.env</span>[<span class="string">'HTTP_X_CUSTOM_VALUE'</span>]</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-10-03T03:56:51.923Z"><a href="/2015/10/02/mysqldb-typeerror-d-format-a-number-is-required-not-str/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/mysqldb-typeerror-d-format-a-number-is-required-not-str/"> MySQLdb: TypeError: %d format: a number is required, not str </a></h1>
  

    </header>
    <div class="entry">
      
        <p>I was getting this error message from MySQLdb:</p>
<p>TypeError: %d format: a number is required, not str</p>
<p>The error message was the result of this code:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">assert <span class="built_in">type</span>(gateway_id) == <span class="keyword">int</span></span><br><span class="line">sql = <span class="string">""</span><span class="string">"</span><br><span class="line"></span>  SELECT meter_id </span><br><span class="line">  FROM mtus </span><br><span class="line">  WHERE gateway_id = %<span class="keyword">d</span> </span><br><span class="line">    AND name = <span class="string">'%s'</span> <span class="string">""</span><span class="string">"</span><br><span class="line"></span>conn = mysql_connect()</span><br><span class="line"><span class="built_in">cursor</span> = conn.<span class="built_in">cursor</span>()</span><br><span class="line"><span class="built_in">cursor</span>.<span class="keyword">execute</span>(sql, (gateway_id, name))</span><br><span class="line"><span class="keyword">ret</span> = <span class="built_in">cursor</span>.fetchone()</span><br><span class="line"><span class="built_in">cursor</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure>
<p>It turns out, execute converts all the arguments to SQL literal values. <a href="http://mysql-python.sourceforge.net/MySQLdb.html#some-examples" target="_blank" rel="external">reference</a> All %Xs should be %s and there shouldn’t be any quotes around them. MySQLdb takes care of the string escaping too.</p>
<h2 id="Other_Causes:">Other Causes:</h2><p>For those of you arriving here from a search and are not having problems with MySQL, the reason for this error is that a string was passed into a format where a number was expected:</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># throws the TypeError:</span></span><br><span class="line"><span class="keyword">message</span> = <span class="string">"%d seconds until done"</span> % <span class="string">"three"</span></span><br><span class="line"><span class="comment"># works:</span></span><br><span class="line"><span class="keyword">message</span> = <span class="string">"%d seconds until done"</span> % <span class="number">3</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
    <a href="/page/4/" class="alignleft prev">Prev</a>
  
  
    <a href="/page/6/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:dwiel.github.io">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Axpress/">Axpress</a><small>2</small></li>
  
    <li><a href="/tags/Bug-Fix/">Bug Fix</a><small>4</small></li>
  
    <li><a href="/tags/CEB-Press/">CEB Press</a><small>6</small></li>
  
    <li><a href="/tags/Code/">Code</a><small>16</small></li>
  
    <li><a href="/tags/Data-Exploration/">Data Exploration</a><small>1</small></li>
  
    <li><a href="/tags/FYI/">FYI</a><small>9</small></li>
  
    <li><a href="/tags/Family/">Family</a><small>1</small></li>
  
    <li><a href="/tags/Food/">Food</a><small>2</small></li>
  
    <li><a href="/tags/Foundation/">Foundation</a><small>3</small></li>
  
    <li><a href="/tags/How-to/">How to</a><small>6</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>11</small></li>
  
    <li><a href="/tags/Music/">Music</a><small>2</small></li>
  
    <li><a href="/tags/Our-House/">Our House</a><small>12</small></li>
  
    <li><a href="/tags/Politics/">Politics</a><small>4</small></li>
  
    <li><a href="/tags/Reflection/">Reflection</a><small>2</small></li>
  
    <li><a href="/tags/Script/">Script</a><small>2</small></li>
  
    <li><a href="/tags/Uncategorized/">Uncategorized</a><small>7</small></li>
  
    <li><a href="/tags/Welcome/">Welcome</a><small>1</small></li>
  
    <li><a href="/tags/Windows/">Windows</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Zach Dwiel
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>